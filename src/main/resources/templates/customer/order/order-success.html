<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Đặt hàng thành công - ActurusBooks</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" />
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/index.css">
</head>

<body>
    <div th:replace="~{fragments/navbar-customer :: navbar}"></div>

    <section class="order-success py-5" style="background:#f8f9fa;">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-8">
                    <!-- Success Message -->
                    <div class="text-center mb-5">
                        <div class="success-icon mb-3">
                            <i class="bi bi-check-circle-fill text-success" style="font-size: 4rem;"></i>
                        </div>
                        <h2 class="fw-bold text-success mb-3">Đặt hàng thành công!</h2>
                        <p class="text-muted">Cảm ơn bạn đã mua sắm tại ActurusBooks. Đơn hàng của bạn đang được xử lý.
                        </p>
                    </div>

                    <!-- Order Info -->
                    <div class="card shadow-sm mb-4">
                        <div class="card-body">
                            <h5 class="fw-bold mb-3">Thông tin đơn hàng</h5>
                            <div class="row">
                                <div class="col-md-6">
                                    <p><strong>Mã đơn hàng:</strong> <span class="text-primary"
                                            th:text="${order.order_id}"></span></p>
                                    <p><strong>Ngày đặt:</strong> <span
                                            th:text="${#temporals.format(order.order_date, 'dd/MM/yyyy HH:mm')}"></span>
                                    </p>
                                    <p><strong>Tổng tiền:</strong> <span class="text-danger fw-bold"
                                            th:text="${#numbers.formatDecimal(order.total_amount, 0, 'POINT', 0, 'COMMA')} + 'đ'"></span>
                                    </p>
                                </div>
                                <div class="col-md-6">
                                    <p><strong>Người nhận:</strong> <span th:text="${order.user.full_name}"></span></p>
                                    <p><strong>Số điện thoại:</strong> <span th:text="${order.phone}"></span></p>
                                    <p><strong>Địa chỉ:</strong> <span th:text="${order.address}"></span></p>
                                    <p><strong>Phương thức thanh toán:</strong> <span
                                            th:text="${order.payment_method}"></span></p>
                                    <p><strong>Trạng thái thanh toán:</strong>
                                        <span
                                            th:class="${order.payment_status == 'Đã thanh toán'} ? 'badge bg-success' : (${order.payment_status == 'Hoàn tiền'} ? 'badge bg-warning' : 'badge bg-secondary')"
                                            th:text="${order.payment_status}"></span>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Order Details -->
                    <div class="card shadow-sm mb-4">
                        <div class="card-body">
                            <h5 class="fw-bold mb-3">Chi tiết sản phẩm</h5>
                            <div class="table-responsive">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>Sản phẩm</th>
                                            <th>Đơn giá</th>
                                            <th>Số lượng</th>
                                            <th>Thành tiền</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr th:each="detail : ${orderDetails}">
                                            <td
                                                th:text="${detail.bookTitle != null} ? ${detail.bookTitle} : (${detail.book != null} ? ${detail.book.title} : ('#' + ${detail.bookId}))">
                                            </td>
                                            <td
                                                th:text="${#numbers.formatDecimal(detail.price, 0, 'POINT', 0, 'COMMA')} + 'đ'">
                                            </td>
                                            <td th:text="${detail.quantity}"></td>
                                            <td
                                                th:text="${#numbers.formatDecimal(detail.subTotal, 0, 'POINT', 0, 'COMMA')} + 'đ'">
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Actions -->
                    <div class="text-center">
                        <a th:href="@{'/order/detail/' + ${order.order_id}}" class="btn btn-success me-3">
                            <i class="bi bi-file-text"></i> Xem chi tiết đơn hàng
                        </a>
                        <a href="/" class="btn btn-primary me-3">
                            <i class="bi bi-house"></i> Về trang chủ
                        </a>
                        <a href="/order/history" class="btn btn-outline-primary">
                            <i class="bi bi-clock-history"></i> Xem lịch sử đơn hàng
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <div th:replace="fragments/footer :: footer"></div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>